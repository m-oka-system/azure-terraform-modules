---
allowed-tools: Bash(git add:*), Bash(git status:*), Bash(git commit:*), Bash(git push:*), Bash(git log:*), Bash(git diff:*), Bash(git rev-list:*)
description: git コミットを作成する
---

## コンテキスト

- 現在の git 状態: !`git status`
- ステージングされた変更: !`git diff --cached`
- 現在のブランチ: !`git branch --show-current`
- 最近のコミット履歴: !`git log --oneline -10`
- リモート追跡状態: !`git rev-list --count @{u}..HEAD 2>/dev/null || echo "no-upstream"`

## 引数

$ARGUMENTS

## タスク

以下のルールに従ってコミットを作成してください。

### 基本ルール

1. **コミットメッセージは日本語で書く**
2. **コミットメッセージは一行で書く**（改行なし）
3. **Conventional Commits 形式に従う**: `<type>: <説明>`
   - type 一覧: `feat`, `fix`, `refactor`, `docs`, `chore`, `test`, `style`
4. **ステージングされた変更内容を反映したメッセージにする**
5. **過去のコミットメッセージのスタイルを参考にする**
6. **Claude Code の署名（Co-Authored-By）は含めない**

### オプション処理

引数 `$ARGUMENTS` に応じて動作を変更：

#### オプションなし（デフォルト）

- ステージングされているファイルをコミットする
- コミットメッセージを生成してコミットを実行

#### `-m` オプション

- コミットメッセージの生成のみを行う
- 実際のコミットは実行しない
- 生成したメッセージをユーザーに表示する

#### `-p` オプション

- コミット後に `git push` を実行する

#### `-a` オプション

- 直前のコミットメッセージを `--amend` で修正する
- **重要**: リモートブランチに push していないことを必ず確認する
  - `git rev-list --count @{u}..HEAD` が 0 の場合は amend を拒否
  - upstream がない場合は amend を許可

### 前提条件チェック

**ステージングされたファイルがない場合**:

- 処理を中断する
- 「ステージングされたファイルがありません。`git add` でファイルをステージングしてください。」とユーザーに通知する
- `-a` オプションの場合はこのチェックをスキップ（amend はステージング不要の場合がある）

### 実行手順

1. ステージングされたファイルの有無を確認（`-a` 以外）
2. オプションに応じた処理を実行
3. コミット実行時は以下の形式を使用：
   ```bash
   git commit -m "<type>: <日本語の説明>"
   ```

他のツールを使用したり、他のことをしないでください。ツール呼び出し以外のテキストやメッセージを送信しないでください。
